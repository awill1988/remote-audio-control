doctype html
html(lang='en',ng-app='app')
	head
		meta(charset='utf-8')
		title= title
		//link(rel='stylesheet', href='css/app.css')
		script( type='text/javascript', src='socket.io/socket.io.js')
		script( type='text/javascript', src='javascripts/nexusui/dist/nexusUI.js')		
		script(type='text/javascript', src='javascripts/jquery.min.js')
		script(type='text/javascript', src='javascripts/angular.min.js')
		script(type='text/javascript', src='javascripts/angular-route.min.js')
		link(rel='stylesheet', href='/stylesheets/style.css')
		script(src='script.js')
		base('/')


		script.
			//console.log(userInfo);
			var socket = io(location.hostname+':'+'#{port}');

			//console.log('socket established');
			socket.on('connect', function() {
				var userInfo = {
					initials: '#{initials}',
					socketid: '/#'+socket.id
				};
				//console.log(userInfo);
				socket.emit('add_user',userInfo);
			});

			socket.on('current_state',function(state){
				//console.log('receiving current state')
				console.log(state.args[0]);

				var currentStateURL = '#' + state.args[0];
				window.location = currentStateURL;

				for(var n in nx.widgets)
				{
					nx.widgets[n].init();
					nx.widgets[n].draw();
				}
				// Force location (navigate via message from socket)
				//window.location = currentStateURL;
				
			});
	body
		h1= title
		div(id='container', ng-view)


		
		
